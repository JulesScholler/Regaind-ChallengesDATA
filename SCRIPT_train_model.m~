% Train a SVM using the pre-generated features and return it for
% evaluation.
%
% Return values:
%   - SVM_model: trained SVM model

% Load the config parameters
SCRIPT_config;

% Load the data
SCRIPT_load_meta;       % metadata for test and train
SCRIPT_load_impact;     % impact for train
SCRIPT_load_score;      % aesthetics score for train
SCRIPT_generate_histo;  % histogram for test and train
SCRIPT_generate_vgg;    % vgg face for test and train

% Assemble the data
% data_train = [meta_train impact_train hist_train face_train];
data_train = meta_train;

% Set parameters
n_fold = 10;            % cross-validation parameters

% Do cross-validation training for evaluation
idx = randperm(10000);  % randomisation indices
for i = 1:n_fold
    % Generate the CV train and test set
    sep_inf = 1+ floor((i-1)*10000/n_fold);     % inferior separator
    sep_sup = floor(i*10000/n_fold);            % superior separator  
    idx_CV_test  = idx(sep_inf:sep_sup);        % CV test indices
    idx_CV_train = idx;                         % CV train indices
    idx_CV_train(sep_inf:sep_sup) = [];         % remove test indices
    data_CV_test  = data_train(idx_CV_test);    % CV test data 
    score_CV_test = score_train(idx_CV_test);   % CV test score  
    data_CV_train = data_train(idx_CV_train);   % CV train data
    
    
end

